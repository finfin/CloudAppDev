/*! MessageBoard 28-06-2013 */
var apns=require("apn"),util=require("util"),log4js=require("log4js"),logger=log4js.getLogger(),options={cert:"config/cert.pem",key:"config/key.pem",gateway:"gateway.sandbox.push.apple.com",port:2195,errorCallback:function(a){logger.error(a)}},apnsConnection=new apns.Connection(options);exports.notification=function(a,b){var c;util.isArray(a)?(c=[],a.forEach(function(a){c.push(new apns.Device(a))})):c=new apns.Device(a);var d=new apns.Notification;d.expiry=Math.floor(Date.now()/1e3)+3600,d.badge=1,d.sound="ping.aiff",d.alert=b,d.payload={messageFrom:"Caroline"},console.log(d,c),apnsConnection.pushNotification(d,c)};var options={batchFeedback:!0,interval:60},feedback=new apns.Feedback(options);feedback.on("feedback",function(a){a.forEach(function(a){logger.warn(a)})});