/*! MessageBoard 28-06-2013 */
var emailer=require("nodemailer"),fs=require("fs"),_=require("underscore"),config=require("../../config/mailer"),Emailer=function(a,b){this.options.mailOption=_.extend(config.mailOption,a)||{},console.log(this.options),this.data=b||{},this.attachments=[]};Emailer.prototype.options=config,Emailer.prototype.send=function(a){var b;return this.options.mailOption.html=this.getHtml(),b=this.getTransport(),b.sendMail(this.options.mailOption,a)},Emailer.prototype.getTransport=function(){return emailer.createTransport("SMTP",this.options.smtpOption)},Emailer.prototype.getHtml=function(){var a,b,c=this.options.mailOption.template;return b="./views/emails/"+c+".html",a=fs.readFileSync(b,"utf8"),_.template(a,this.data,{interpolate:/\{\{(.+?)\}\}/g})},exports=module.exports=Emailer;